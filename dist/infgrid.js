require=function(r,e,n){function t(n,o){function i(r){return t(i.resolve(r))}function f(e){return r[n][1][e]||e}if(!e[n]){if(!r[n]){var c="function"==typeof require&&require;if(!o&&c)return c(n,!0);if(u)return u(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}i.resolve=f;var s=e[n]=new t.Module(n);r[n][0].call(s.exports,i,s,s.exports)}return e[n].exports}function o(r){this.id=r,this.bundle=t,this.exports={}}var u="function"==typeof require&&require;t.isParcelRequire=!0,t.Module=o,t.modules=r,t.cache=e,t.parent=u;for(var i=0;i<n.length;i++)t(n[i]);return t}({3:[function(require,module,exports) {

},{}],11:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let e={};const t=exports.ConfigurationService={Initialize(){},GetData(e){},SetData(e,t){}};
},{}],10:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=exports.ObserverService={Cache:{AwaitedElements:{}},async AwaitElement(e){return this.Cache.AwaitedElements[e]?this.Cache.AwaitedElements[e]:(this.Cache.AwaitedElements[e]=new Promise(t=>{if(document.querySelector(e))return t();let n=new MutationObserver(r=>{for(const o of r)for(const r of Array.from(o.addedNodes))r.nodeType===Node.ELEMENT_NODE&&r.matches(e)&&(n.disconnect(),t())});n.observe(document.documentElement,{childList:!0,subtree:!0})}),this.Cache.AwaitedElements[e])},AwaitChild:(e,t)=>new Promise(n=>{if(Array.from(e.children).find(e=>e.matches(t)))return n();const r=new MutationObserver(e=>{for(const o of e)for(const e of Array.from(o.addedNodes))e.nodeType===Node.ELEMENT_NODE&&e.matches(t)&&(r.disconnect(),n())});r.observe(e,{childList:!0})}),AwaitEvent:(e,t,n)=>(n=n||(()=>!0),new Promise(r=>e.addEventListener(t,function o(s){n(s)&&r(e.removeEventListener(t,o))})))};
},{}],12:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let e={};const t=exports.CSSInjectorService={Inject:t=>e[t]?e[t].sheet:(e[t]=document.createElement("style"),document.head.appendChild(e[t]),e[t].sheet),Delete(t){e[t].remove()}};
},{}],5:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./configuration");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});var r=require("./observer");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})});var t=require("./cssinjector");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}})});
},{"./configuration":11,"./observer":10,"./cssinjector":12}],8:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=exports.STAGE={STATE:Symbol("StageState"),INIT:Symbol("StageInitialization"),RUN:Symbol("StageRun"),DESTROY:Symbol("StageDestroy"),PAUSED:Symbol("StagePaused")};
},{}],7:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LocationProvider=exports.PAGE_TYPE=void 0;var e=require(".");const t=exports.PAGE_TYPE={FRONTPAGE:1,SUB:2,THREAD:3},o={FRONTPAGE:/^\/(?:hot|new|rising|controversial|top)?(?:\/|$)/i,SUB:/^\/r\/([\w_]+)(?:(?:\/(?:hot|new|rising|controversial|top)?\/?$)|$)/i,THREAD:/^\/(?:r\/([\w\.]+)\/|(u(?:ser)?\/[\w-]+)\/)?comments\/([a-z0-9]+)(?:\/|$)/i},i=exports.LocationProvider={PageType:0,Initialize(){this.UpdatePageType()},UpdatePageType(){for(const e in o)if(o[e].test(location.pathname)){this.PageType=t[e];break}},get SubName(){return this._SubName||(this._SubName=o.SUB.exec(location.pathname)[1])}};
},{".":4}],9:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e={SiteTable:"#siteTable",Sidebar:"body > .side",Footer:"body > .footer-parent",Comment:".thing[id^=thing_t1_]",Thread:".thing[id^=thing_t3_]"};e.Threads=e.SiteTable+" "+e.Thread,e.NavigationButtons=e.SiteTable+" > .nav-buttons",exports.Selectors=e;
},{}],4:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./execution");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});var r=require("./location");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})});var t=require("./selectors");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}})});
},{"./execution":8,"./location":7,"./selectors":9}],17:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GridModule=void 0;var e=require("../providers/"),t=require("../services"),s=require("../managers");const r=exports.GridModule={USE_ON:[e.PAGE_TYPE.FRONTPAGE,e.PAGE_TYPE.SUB],DefaultValues:{ColumnsCount:5},Columns:[],async[e.STAGE.INIT](){await t.ObserverService.AwaitElement("html > body"),s.StylesManager.DisableCustomStyles(),this.Stylesheet=t.CSSInjectorService.Inject("GridModule"),await t.ObserverService.AwaitElement(e.Selectors.SiteTable),this.CreateColumns(),this.ProcessSiteTable(),document.querySelector(e.Selectors.SiteTable).classList.add("gridview")},ObserveThreadInsertion(){this.ThreadsObserver=new MutationObserver(t=>{for(const s of t)Array.from(s.addedNodes).filter(e=>e.nodeType===Node.ELEMENT_NODE).forEach(t=>{t.matches(e.Selectors.Thread)?this.ProcessThread(t):t.matches(".clearleft")&&t.remove()})}),this.ThreadsObserver.observe(document.querySelector(e.Selectors.SiteTable),{childList:!0})},CreateColumns(){for(let t=0;t<this.DefaultValues.ColumnsCount;t++){let s=document.createElement("div");s.classList.add("grid-column"),0!=t&&s.classList.add("leftgap"),document.querySelector(e.Selectors.SiteTable).appendChild(s),this.Columns.push(s)}this.Stylesheet.insertRule(`.gridview {\n\t\t\tgrid-template-columns: repeat( ${this.Columns.length}, ${100/this.Columns.length}% );\n\t\t}`)},ProcessSiteTable(){document.querySelectorAll(e.Selectors.SiteTable+" > .clearleft").forEach(e=>e.remove()),document.querySelectorAll(e.Selectors.Threads).forEach(e=>this.ProcessThread(e))},ProcessThread(e){let t;this.Columns.forEach(e=>t=t?e.offsetHeight<t.offsetHeight?e:t:e),t.appendChild(e);let s=e.querySelector(":scope > .entry .top-matter .title"),r=e.querySelector(":scope > .entry .top-matter .tagline"),a=e.querySelector(":scope > .entry .top-matter .flat-list");s.classList.add("card-header"),r.classList.add("card-sub-infos"),a.classList.add("card-actions");let l=a.querySelector(":scope a.comments");l&&(l.textContent=l.textContent.replace(/comments?/,"")),this.LoadContent(e),e.appendChild(s),e.appendChild(r),e.appendChild(a)},async LoadContent(e){let t,s,r,a,l=e.getAttribute("data-url");if(!l)return;if(l.startsWith("/"))t="self";else{if(s=(a=new URL(l)).hostname.match("([^.]+).[^.]+?$")[1],r=a.href.replace(/^(http)([^s])/,"https$2"),-1==a.pathname.indexOf(".")&&"imgur"==s)return;switch(s){case"imgur":r=r.replace(/(gifv?)$/,"mp4"),t="media";break;case"gfycat":r=r.replace(/^(.+?\/\/)()(g)/,"$1giant.$3")+".webm",t="media";break;default:return}}if(!t)return;let o="img";"media"==t&&/(?:gifv?|mp4|webm)$/.test(r.match(/[^\.]+$/)[0])&&(o="video"),"self"==t&&(o="span");let i=document.createElement("div");i.classList.add("card-content");let n=document.createElement(o);switch(i.appendChild(n),o){case"video":n.setAttribute("src",r),n.loop=!0,n.muted=!0,i.classList.add("video"),n.addEventListener("click",()=>n.paused?(n.play(),n.controls=!0,i.classList.add("play")):(n.pause(),n.controls=!1,i.classList.remove("play")));break;case"img":n.setAttribute("src",r);break;case"span":let e=await fetch(location.origin+l),t=document.implementation.createHTMLDocument();t.documentElement.innerHTML=await e.text();let s=t.querySelector(":scope #siteTable .thing .usertext-body p");if(!s)break;t.documentElement.innerHTML="",n.textContent=s.textContent,n.classList.add("text")}e.appendChild(i)},[e.STAGE.RUN](){this.ObserveThreadInsertion()},[e.STAGE.DESTROY](){this.ThreadsObserver.disconnect(),this.Stylesheet.ownerNode.remove(),s.StylesManager.EnableCustomStyles();let t=document.querySelector(e.Selectors.SiteTable);for(const e of this.Columns){for(const s of e.childNodes)t.appendChild(s);e.remove()}this.ElementsCount=0}};
},{"../providers/":4,"../services":5,"../managers":6}],20:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e="InfiniteGrid",t="IG";exports.TAG=e,exports.TAG_HTML="IG";
},{}],22:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class e{constructor(e){return this.Element=e||document.createElement("div"),Object.assign(this.Element,this)}remove(){return this.destructor&&this.destructor(),!!this.Element.parentNode&&this.Element.parentNode.removeChild(this.Element)}}exports.BaseView=e;
},{}],21:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SentinelView=void 0;var e=require("./base");const t=function(e){this.Element.dispatchEvent(new CustomEvent("PresenceChange",{detail:{visible:e[0].intersectionRatio>0}}))};class s extends e.BaseView{static get tagName(){return"sentinel"}constructor(e){super(e),this.Observer=new IntersectionObserver(t.bind(this)),this.Observer.observe(this.Element)}destructor(){this.Observer.unobserve(this.Element)}}exports.SentinelView=s;
},{"./base":22}],16:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InfiniteFeedModule=exports.NextFeedFetcherSentinelId=void 0;var e=require("../core/tags"),t=require("../providers/"),i=require("../views/sentinel"),n=require("../services");const s=exports.NextFeedFetcherSentinelId=e.TAG_HTML+"NextFeedFetcher",a=/<style(.|\s)*?>|<link(.|\s)*?>|<script(.|\s)*?\/script>/g,r=exports.InfiniteFeedModule={USE_ON:[t.PAGE_TYPE.FRONTPAGE,t.PAGE_TYPE.SUB],DESCRIPTION:"Load the next page content upon reaching the bottom of the page",NextPage:"",async[t.STAGE.INIT](){await n.ObserverService.AwaitElement(t.Selectors.NavigationButtons),this.NavigationButtons=document.querySelector(t.Selectors.NavigationButtons),this.NavigationButtons.style.display="none"},[t.STAGE.RUN](){this.SiteTable=document.querySelector(t.Selectors.SiteTable),this.NextFeedContainer=document.createElement("div"),this.Sentinel=new i.SentinelView,this.Sentinel.setAttribute("id",s),this.Sentinel.addEventListener("PresenceChange",e=>e.detail.visible&&!this.Retrieving&&!this.ReachedEnd&&this.NextPage&&this.LoadNextPage()),this.SiteTable.parentNode.insertBefore(this.Sentinel.Element,this.SiteTable.nextSibling),this.NextPage=this.NavigationButtons.querySelector(":scope .next-button > a").href},async LoadNextPage(){this.Retrieving=!0;let e=await fetch(this.NextPage,{credentials:"include"});this.NextFeedContainer.innerHTML=(await e.text()).replace(a,"");for(const e of this.NextFeedContainer.querySelectorAll(t.Selectors.SiteTable+" > *:not(.nav-buttons)"))this.SiteTable.appendChild(e);this.NextPage=await this.NextFeedContainer.querySelector(t.Selectors.NavigationButtons+" .next-button > a"),this.NextPage?this.NextPage=this.NextPage.href:this.ReachedEnd=!0,this.Retrieving=!1},[t.STAGE.DESTROY](){this.Sentinel.remove(),document.querySelector(t.Selectors.NavigationButtons).style.display=""}};
},{"../core/tags":20,"../providers/":4,"../views/sentinel":21,"../services":5}],18:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SidebarModule=void 0;var e=require("../providers/location"),r=require("../providers");const o=exports.SidebarModule={USE_ON:[e.PAGE_TYPE.FRONTPAGE,e.PAGE_TYPE.SUB],Configuration:{},[r.STAGE.RUN](){},[r.STAGE.DESTROY](){}};
},{"../providers/location":7,"../providers":4}],15:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./grid");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});var r=require("./infinitefeed");Object.defineProperty(exports,"InfiniteFeedModule",{enumerable:!0,get:function(){return r.InfiniteFeedModule}});var t=require("./sidebar");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}})});
},{"./grid":17,"./infinitefeed":16,"./sidebar":18}],13:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModulesManager=void 0;var e=require("../providers/location"),t=require("../modules/"),a=o(t),s=require("../providers");function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}const u=exports.ModulesManager={async ExecuteModulesStage(e){Promise.all(this.PageModules.filter(t=>t[e]).map(async t=>await this.ExecuteModuleStage(t,e)))},async ExecuteModuleStage(e,t){"string"==typeof e&&(e=a[e]),await e[t](),e[s.STAGE.STATE]=t},IsModuleUsable:t=>a[t].USE_ON&&a[t].USE_ON.includes(e.LocationProvider.PageType),get PageModules(){if(this.CachedPageModules)return this.CachedPageModules;this.CachedPageModules=[];for(const e in a)this.IsModuleUsable(e)&&this.CachedPageModules.push(a[e]);return this.CachedPageModules},IsModuleActivated:e=>a[e][s.STAGE.STATE]&&a[e][s.STAGE.STATE]==s.STAGE.RUN,ActivateModule(e){!this.IsModuleActivated(e)&&ExecuteModuleStage(e,s.STAGE.INIT)&&ExecuteModuleStage(e,s.STAGE.RUN)},DisableModule(e){this.IsModuleActivated(e)&&ExecuteModuleStage(e,s.STAGE.DESTROY)}};
},{"../providers/location":7,"../modules/":15,"../providers":4}],14:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StylesManager=void 0;var e=require("../services");const t=exports.StylesManager={Documents:{},async Initialize(){await e.ObserverService.AwaitElement("html > body"),this.DisableCustomStyles()},GetCustomStylesheet(e){if(e=e||document,void 0!==this.Documents[e])return this.Documents[e];for(const t of e.styleSheets)if(t.title&&"applied_subreddit_stylesheet"==t.title)return this.Documents[e]=t;return this.Documents[e]=!1,e.documentElement.classList.add("noCustomStyles"),this.Documents[e]},DisableCustomStyles(e){let t=this.GetCustomStylesheet(e);0!=t&&(t.disabled=!0,document.documentElement.classList.add("customStylesDisabled"))},EnableCustomStyles(e){let t=this.GetCustomStylesheet(e);0!=t&&(t.disabled=!0,e.documentElement.classList.remove("customStylesDisabled"))}};
},{"../services":5}],6:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./modules");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});var r=require("./styles");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})});
},{"./modules":13,"./styles":14}],2:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Extension=void 0,require("./styles/main.scss");var e=require("../services/"),i=require("../providers/"),r=require("../managers/");const t=exports.Extension={async Initialize(){i.LocationProvider.Initialize(),e.ConfigurationService.Initialize(),r.StylesManager.Initialize(),r.ModulesManager.ExecuteModulesStage(i.STAGE.INIT),await e.ObserverService.AwaitEvent(document,"DOMContentLoaded"),r.ModulesManager.ExecuteModulesStage(i.STAGE.RUN)}};
},{"./styles/main.scss":3,"../services/":5,"../providers/":4,"../managers/":6}],1:[function(require,module,exports) {
"use strict";var i=require("./core/init");i.Extension.Initialize();
},{"./core/init":2}]},{},[1])